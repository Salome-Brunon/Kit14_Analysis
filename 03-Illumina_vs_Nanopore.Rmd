# Illumina vs Nanopore
**Load Libraries**

```{r, message=FALSE, warning=FALSE}
library(FactoMineR)
library(readxl)
library(ggrepel)
library(ggplot2)
library(ggpubr)
library(kableExtra)
library(tidyverse)
library(hrbrthemes)
library(tm)
library(proustr)
library(VennDiagram)
library(gespeR)
library(EnhancedVolcano)
library(FoldGO)
library(topGO)
library(org.Hs.eg.db)
library(clusterProfiler)
```

**Load Normalised Expression and DESeq2 Data**
```{r echo=TRUE, message=FALSE, warning=FALSE}
#Normalised Count Data
count_illumina <- read.table('~/shares-net/sequencages/analyses/cDNAKit14_A2022/deseq2_output/deseq2_Experiment1-normalisation_normalisedCountMatrix.tsv', header = TRUE, sep = '\t')
count_Kit11 <- read.table('~/shares-net/sequencages/analyses/P2solo_cDNA_R9_B2023/deseq2_output/deseq2_Experiment1-normalisation_normalisedCountMatrix.tsv', header =TRUE, sep='\t')
count_Kit9 <- read.table('~/shares-net/sequencages/analyses/cDNAKit14_B2022/deseq2_output/deseq2_Experiment1-normalisation_normalisedCountMatrix.tsv', header =TRUE, sep='\t')
count_P2 <- read.table('~/shares-net/sequencages/analyses/P2solo_cDNA_R9_B2023_P2/deseq2_output/deseq2_Experiment1-normalisation_normalisedCountMatrix.tsv', header =TRUE, sep='\t')

#DESeq2
convert_commas_to_periods <- function(df, columns) {
  for (col in columns) {
    df[[col]] <- as.numeric(gsub(",", ".", df[[col]]))
  }
  return(df)
}

# Specify the columns to convert commas to periods
columns_to_convert <- c("log2foldchange.LLO.vs.Neg", "BH.adjusted.p.values")

genes_illumina <- read_csv('~/shares-net/sequencages/analyses/cDNAKit14_A2022/diffanaresultsannotation_output/diffanaresultsannotation_deseq2_Experiment1-diffana_LLO_vs_Neg.csv')
genes_illumina <- genes_illumina[,c(1,3,7,10)]
colnames(genes_illumina) <- c('Id', "log2foldchange.LLO.vs.Neg", "BH.adjusted.p.values", "Symbol")
genes_illumina <- convert_commas_to_periods(genes_illumina, columns_to_convert)
genes_illumina <- genes_illumina[!is.na(genes_illumina$log2foldchange.LLO.vs.Neg),]
genes_illumina <- genes_illumina[!is.na(genes_illumina$BH.adjusted.p.values),]

genes_Kit11 <- read.table('~/shares-net/sequencages/analyses/P2solo_cDNA_R9_B2023/diffanaresultsannotation_output/diffanaresultsannotation_deseq2_Experiment1-diffana_LLO_vs_Neg.tsv', header =TRUE, sep='\t')
genes_Kit11 <- genes_Kit11[,c(1,3,7,10)]
colnames(genes_Kit11) <- c('Id', "log2foldchange.LLO.vs.Neg", "BH.adjusted.p.values", "Symbol")
genes_Kit11$log2foldchange.LLO.vs.Neg <- as.numeric(genes_Kit11$log2foldchange.LLO.vs.Neg)
genes_Kit11$BH.adjusted.p.values <- as.numeric(genes_Kit11$BH.adjusted.p.values)


genes_Kit9 <- read.table('~/shares-net/sequencages/analyses/cDNAKit14_B2022/diffanaresultsannotation_output/diffanaresultsannotation_deseq2_Experiment1-diffana_LLO_vs_Neg.tsv', header =TRUE, sep='\t')
genes_Kit9 <- genes_Kit9[,c(1,3,7,10)]
colnames(genes_Kit9) <- c('Id', "log2foldchange.LLO.vs.Neg", "BH.adjusted.p.values", "Symbol")
genes_Kit9$log2foldchange.LLO.vs.Neg <- as.numeric(genes_Kit9$log2foldchange.LLO.vs.Neg)
genes_Kit9$BH.adjusted.p.values <- as.numeric(genes_Kit9$BH.adjusted.p.values)


genes_P2 <- read.table('~/shares-net/sequencages/analyses/P2solo_cDNA_R9_B2023_P2/diffanaresultsannotation_output/diffanaresultsannotation_deseq2_Experiment1-diffana_LLO_vs_Neg.tsv', header =TRUE, sep='\t')
genes_P2 <- genes_P2[,c(1,3,7,10)]
colnames(genes_P2) <- c('Id', "log2foldchange.LLO.vs.Neg", "BH.adjusted.p.values", "Symbol")
genes_P2$log2foldchange.LLO.vs.Neg <- as.numeric(genes_P2$log2foldchange.LLO.vs.Neg)
genes_P2$BH.adjusted.p.values <- as.numeric(genes_P2$BH.adjusted.p.values)

```

**PCA**

```{r}

# Create a matrix from our table of counts
Illumina_pca_matrix <- count_illumina %>% 
  # make the "gene" column become the rownames of the table
  column_to_rownames("Id") %>% 
  # coerce to a matrix
  as.matrix() %>% 
  # transpose the matrix so that rows = samples and columns = variables
  t()

Kit11_pca_matrix <- count_Kit11 %>% 
  column_to_rownames("Id") %>% 
  as.matrix() %>% 
  t()

P2_pca_matrix <- count_P2 %>% 
  column_to_rownames("Id") %>% 
  as.matrix() %>% 
  t()

Illumina_pca_result <- PCA(Illumina_pca_matrix, graph = FALSE)
Kit11_pca_result <- PCA(Kit11_pca_matrix, graph = FALSE) 
P2_pca_result <- PCA(P2_pca_matrix, graph = FALSE)

combined_pca_matrix <- cbind(Illumina_pca_matrix, Kit11_pca_matrix)
combined_pca_matrix <- cbind(combined_pca_matrix, P2_pca_matrix)
combined_pca_result <- PCA(combined_pca_matrix, graph = FALSE)
variance_dim1 <- round(combined_pca_result$eig[1, "percentage of variance"], 2)
variance_dim2 <- round(combined_pca_result$eig[2, "percentage of variance"], 2)

# Create a dataframe for PCA results
Illumina_pca_df <- as.data.frame(Illumina_pca_result$ind$coord)

# Map the colours to appropriate labels
Illumina_pca_df$condition <- c(rep("LLO", 3),
                          rep("Neg", 3))
Illumina_pca_df$protocol  <- c(rep("Illumina", 6))
Illumina_pca_df$samples <- rownames(Illumina_pca_df)


P2_pca_df <- as.data.frame(P2_pca_result$ind$coord)
P2_pca_df$condition  <- c(rep("LLO", 3),
                          rep("Neg", 3))
P2_pca_df$protocol  <- c(rep("P2_Kit11", 6))
P2_pca_df$samples <- rownames(P2_pca_df)


Kit11_pca_df <- as.data.frame(Kit11_pca_result$ind$coord)

Kit11_pca_df$condition  <- c(rep("LLO", 3),
                          rep("Neg", 3))
Kit11_pca_df$protocol  <- c(rep("Kit11", 6))
Kit11_pca_df$samples <- rownames(Kit11_pca_df)


# Combine the dataframes
combined_pca_df <- rbind(Illumina_pca_df, P2_pca_df, Kit11_pca_df)

# Create a custom PCA plot using ggplot2
pca_plot <- ggplot(combined_pca_df, aes(x = Dim.1, y = Dim.2, color = condition, shape = protocol, label = samples)) +
  geom_point(size = 3) +
  geom_text_repel(size = 3)  +  # Add text labels with a slight offset
  scale_color_manual(values = c(Neg = "#B276B2", LLO = "#FAA43A")) +
  scale_shape_manual(values = c(Illumina = "circle", P2_Kit11 = "square", Kit11 = "triangle")) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "grey75") +  # Add horizontal line at y = 0
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey75") +  # Add vertical line at x = 0
  labs(title = "PCA - All Samples",
       x = paste0("Dim.1 (", variance_dim1, "%)"),
       y = paste0("Dim.2 (", variance_dim2, "%)"))

print(pca_plot)

```


**Scatter Plots of Normalised Counts**

**Illumina vs P2**
```{r, fig.height=20, fig.width=10}
illumina_genes_list <- read.table("Illumina_DEG.csv", sep=',', header=TRUE)
illumina_genes_list <- illumina_genes_list$Id

count_P2_colour <- count_P2
count_P2_colour$colour <- rep('grey75', nrow(count_P2_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_P2_colour)) {
    if (count_P2_colour$Id[id] == gene) {
      count_P2_colour$colour[id] <- "#B276B2"
    }
  }
}

count_P2_colour_filt <- count_P2_colour %>%
  filter(Id %in% illumina_genes_list)
count_illu_filt <- count_illumina %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_P2_Illu <- ggplot(count_P2_colour, aes(x = LLO1, y = count_illumina$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_P2_Illu <- ggplot(count_P2_colour, aes(x = LLO2, y = count_illumina$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_P2_Illu <- ggplot(count_P2_colour, aes(x = LLO3, y = count_illumina$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_P2_Illu <- ggplot(count_P2_colour, aes(x = Neg1, y = count_illumina$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_P2_Illu <- ggplot(count_P2_colour, aes(x = Neg2, y = count_illumina$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_P2_Illu <- ggplot(count_P2_colour, aes(x = Neg3, y = count_illumina$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = LLO1, y = count_illu_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
LLO2_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = LLO2, y = count_illu_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
LLO3_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = LLO3, y = count_illu_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
Neg1_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = Neg1, y = count_illu_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
Neg2_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = Neg2, y = count_illu_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
Neg3_P2_Illu_filt <- ggplot(count_P2_colour_filt, aes(x = Neg3, y = count_illu_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "P2 Normalised Count",
       y = "Illumina Normalised Count")
ggarrange(LLO1_P2_Illu, LLO1_P2_Illu_filt,
          LLO2_P2_Illu, LLO2_P2_Illu_filt,
          LLO3_P2_Illu, LLO3_P2_Illu_filt,
          Neg1_P2_Illu, Neg1_P2_Illu_filt,
          Neg2_P2_Illu, Neg2_P2_Illu_filt,
          Neg3_P2_Illu, Neg3_P2_Illu_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**Illumina vs Kit9**
```{r echo=FALSE, fig.height=20, fig.width=10}
count_Kit9_colour <- count_Kit9
count_Kit9_colour$colour <- rep('grey75', nrow(count_Kit9_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_Kit9_colour)) {
    if (count_Kit9_colour$Id[id] == gene) {
      count_Kit9_colour$colour[id] <- "#B276B2"
    }
  }
}

count_Kit9_colour_filt <- count_Kit9_colour %>%
  filter(Id %in% illumina_genes_list)
count_illu_filt <- count_illumina %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = LLO1, y = count_illumina$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = LLO2, y = count_illumina$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = LLO3, y = count_illumina$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = Neg1, y = count_illumina$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = Neg2, y = count_illumina$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_Kit9_Illu <- ggplot(count_Kit9_colour, aes(x = Neg3, y = count_illumina$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO1, y = count_illu_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
LLO2_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO2, y = count_illu_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
LLO3_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO3, y = count_illu_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
Neg1_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg1, y = count_illu_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
Neg2_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg2, y = count_illu_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
Neg3_Kit9_Illu_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg3, y = count_illu_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "Kit9 Normalised Count",
       y = "Illumina Normalised Count")
ggarrange(LLO1_Kit9_Illu, LLO1_Kit9_Illu_filt,
          LLO2_Kit9_Illu, LLO2_Kit9_Illu_filt,
          LLO3_Kit9_Illu, LLO3_Kit9_Illu_filt,
          Neg1_Kit9_Illu, Neg1_Kit9_Illu_filt,
          Neg2_Kit9_Illu, Neg2_Kit9_Illu_filt,
          Neg3_Kit9_Illu, Neg3_Kit9_Illu_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**Illumina vs Kit11**
```{r echo=FALSE, fig.height=20, fig.width=10}
count_Kit11_colour <- count_Kit11
count_Kit11_colour$colour <- rep('grey75', nrow(count_Kit11_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_Kit11_colour)) {
    if (count_Kit11_colour$Id[id] == gene) {
      count_Kit11_colour$colour[id] <- "#B276B2"
    }
  }
}

count_Kit11_colour_filt <- count_Kit11_colour %>%
  filter(Id %in% illumina_genes_list)
count_illu_filt <- count_illumina %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = LLO1, y = count_illumina$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = LLO2, y = count_illumina$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = LLO3, y = count_illumina$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = Neg1, y = count_illumina$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = Neg2, y = count_illumina$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_Kit11_Illu <- ggplot(count_Kit11_colour, aes(x = Neg3, y = count_illumina$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO1, y = count_illu_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
LLO2_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO2, y = count_illu_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
LLO3_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO3, y = count_illu_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
Neg1_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg1, y = count_illu_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
Neg2_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg2, y = count_illu_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
Neg3_Kit11_Illu_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg3, y = count_illu_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "Kit11 Normalised Count",
       y = "Illumina Normalised Count")
ggarrange(LLO1_Kit11_Illu, LLO1_Kit11_Illu_filt,
          LLO2_Kit11_Illu, LLO2_Kit11_Illu_filt,
          LLO3_Kit11_Illu, LLO3_Kit11_Illu_filt,
          Neg1_Kit11_Illu, Neg1_Kit11_Illu_filt,
          Neg2_Kit11_Illu, Neg2_Kit11_Illu_filt,
          Neg3_Kit11_Illu, Neg3_Kit11_Illu_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**P2_Kit11 vs MinION_Kit9**
```{r echo=FALSE, fig.height=20, fig.width=10}
count_Kit9_colour <- count_Kit9
count_Kit9_colour$colour <- rep('grey75', nrow(count_Kit9_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_Kit9_colour)) {
    if (count_Kit9_colour$Id[id] == gene) {
      count_Kit9_colour$colour[id] <- "#B276B2"
    }
  }
}

count_Kit9_colour_filt <- count_Kit9_colour %>%
  filter(Id %in% illumina_genes_list)
count_P2_filt <- count_P2 %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = LLO1, y = count_P2$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = LLO2, y = count_P2$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = LLO3, y = count_P2$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = Neg1, y = count_P2$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = Neg2, y = count_P2$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_Kit9_P2 <- ggplot(count_Kit9_colour, aes(x = Neg3, y = count_P2$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO1, y = count_P2_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
LLO2_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO2, y = count_P2_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
LLO3_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = LLO3, y = count_P2_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
Neg1_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg1, y = count_P2_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
Neg2_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg2, y = count_P2_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
Neg3_Kit9_P2_filt <- ggplot(count_Kit9_colour_filt, aes(x = Neg3, y = count_P2_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "Kit9 Normalised Count",
       y = "P2 Normalised Count")
ggarrange(LLO1_Kit9_P2, LLO1_Kit9_P2_filt,
          LLO2_Kit9_P2, LLO2_Kit9_P2_filt,
          LLO3_Kit9_P2, LLO3_Kit9_P2_filt,
          Neg1_Kit9_P2, Neg1_Kit9_P2_filt,
          Neg2_Kit9_P2, Neg2_Kit9_P2_filt,
          Neg3_Kit9_P2, Neg3_Kit9_P2_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**P2_Kit11 vs MinION_Kit11**
```{r echo=FALSE, fig.height=20, fig.width=10}
count_Kit11_colour <- count_Kit11
count_Kit11_colour$colour <- rep('grey75', nrow(count_Kit11_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_Kit11_colour)) {
    if (count_Kit11_colour$Id[id] == gene) {
      count_Kit11_colour$colour[id] <- "#B276B2"
    }
  }
}

count_Kit11_colour_filt <- count_Kit11_colour %>%
  filter(Id %in% illumina_genes_list)
count_P2_filt <- count_P2 %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = LLO1, y = count_P2$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = LLO2, y = count_P2$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = LLO3, y = count_P2$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = Neg1, y = count_P2$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = Neg2, y = count_P2$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_Kit11_P2 <- ggplot(count_Kit11_colour, aes(x = Neg3, y = count_P2$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO1, y = count_P2_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
LLO2_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO2, y = count_P2_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
LLO3_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO3, y = count_P2_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
Neg1_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg1, y = count_P2_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
Neg2_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg2, y = count_P2_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
Neg3_Kit11_P2_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg3, y = count_P2_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "Kit11 Normalised Count",
       y = "P2 Normalised Count")
ggarrange(LLO1_Kit11_P2, LLO1_Kit11_P2_filt,
          LLO2_Kit11_P2, LLO2_Kit11_P2_filt,
          LLO3_Kit11_P2, LLO3_Kit11_P2_filt,
          Neg1_Kit11_P2, Neg1_Kit11_P2_filt,
          Neg2_Kit11_P2, Neg2_Kit11_P2_filt,
          Neg3_Kit11_P2, Neg3_Kit11_P2_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**MinION_Kit9 vs MinION_Kit11**
```{r echo=FALSE, fig.height=20, fig.width=10}
count_Kit11_colour <- count_Kit11
count_Kit11_colour$colour <- rep('grey75', nrow(count_Kit11_colour))

for (gene in illumina_genes_list) {
  for (id in 1:nrow(count_Kit11_colour)) {
    if (count_Kit11_colour$Id[id] == gene) {
      count_Kit11_colour$colour[id] <- "#B276B2"
    }
  }
}

count_Kit11_colour_filt <- count_Kit11_colour %>%
  filter(Id %in% illumina_genes_list)
count_Kit9_filt <- count_Kit9 %>%
  filter(Id %in% illumina_genes_list)

##All normalised counts of genes plotted
LLO1_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = LLO1, y = count_Kit9$LLO1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO1",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")

LLO2_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = LLO2, y = count_Kit9$LLO2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO2",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
LLO3_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = LLO3, y = count_Kit9$LLO3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of LLO3",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg1_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = Neg1, y = count_Kit9$Neg1, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg1",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg2_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = Neg2, y = count_Kit9$Neg2, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg2",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")
Neg3_Kit11_Kit9 <- ggplot(count_Kit11_colour, aes(x = Neg3, y = count_Kit9$Neg3, colour = colour)) +
  geom_point(size = 1) +
  labs(title = "Scatter plot of Neg3",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count",
       colour = "Genes") +
  scale_color_identity(name = "Genes",
                       labels = c("Illumina DEGs", "Illumina non DEGs"),
                       guide = guide_legend(override.aes = list(alpha = c(0.75, 1)))) +
  theme(legend.position = "bottom")


##Only DEGs genes plotted
LLO1_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO1, y = count_Kit9_filt$LLO1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO1",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
LLO2_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO2, y = count_Kit9_filt$LLO2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO2",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
LLO3_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = LLO3, y = count_Kit9_filt$LLO3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for LLO3",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
Neg1_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg1, y = count_Kit9_filt$Neg1)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg1",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
Neg2_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg2, y = count_Kit9_filt$Neg2)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg2",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
Neg3_Kit11_Kit9_filt <- ggplot(count_Kit11_colour_filt, aes(x = Neg3, y = count_Kit9_filt$Neg3)) +
  geom_point(colour="#B276B2") +
  labs(title = "Scatter plot of Illumina DEGs for Neg3",
       x = "Kit11 Normalised Count",
       y = "Kit9 Normalised Count")
ggarrange(LLO1_Kit11_Kit9, LLO1_Kit11_Kit9_filt,
          LLO2_Kit11_Kit9, LLO2_Kit11_Kit9_filt,
          LLO3_Kit11_Kit9, LLO3_Kit11_Kit9_filt,
          Neg1_Kit11_Kit9, Neg1_Kit11_Kit9_filt,
          Neg2_Kit11_Kit9, Neg2_Kit11_Kit9_filt,
          Neg3_Kit11_Kit9, Neg3_Kit11_Kit9_filt,
          nrow= 6, ncol=2, common.legend = TRUE, widths = c(10, 10), heights = c(50, 50))
```

**Volcano Plots**

```{r, echo=FALSE, fig.height=20, fig.width=23, message=FALSE, warning=FALSE}
colours <- c("grey", "#FAA43A", "#3399cc", "#B276B2")
illumina_volcano <- EnhancedVolcano(genes_illumina,
                lab = genes_illumina$Symbol,
                x = 'log2foldchange.LLO.vs.Neg',
                y = 'BH.adjusted.p.values',
                xlab = bquote(~Log[2]~ 'fold change'),
                pCutoff = 0.05,
                FCcutoff = 1,
                pointSize = 2.0,
                labSize = 5.0,
                title = "Illumina",
                subtitle = NULL,
                colAlpha = 1,
                legendPosition = 'bottom',
                legendLabSize = 12,
                legendIconSize = 4.0,
                drawConnectors = TRUE,
                widthConnectors = 0.2,
                col=colours)
P2_volcano <- EnhancedVolcano(genes_P2,
                lab = genes_P2$Symbol,
                x = 'log2foldchange.LLO.vs.Neg',
                y = 'BH.adjusted.p.values',
                xlab = bquote(~Log[2]~ 'fold change'),
                pCutoff = 0.05,
                FCcutoff = 1,
                pointSize = 2.0,
                labSize = 5.0,
                colAlpha = 1,
                title = "P2_Kit11",
                subtitle = NULL,
                legendPosition = 'bottom',
                legendLabSize = 12,
                legendIconSize = 4.0,
                drawConnectors = TRUE,
                widthConnectors = 0.2,
                col=colours)

Kit11_volcano <- EnhancedVolcano(genes_Kit11,
                lab = genes_Kit11$Symbol,
                x = 'log2foldchange.LLO.vs.Neg',
                y = 'BH.adjusted.p.values',
                xlab = bquote(~Log[2]~ 'fold change'),
                pCutoff = 0.05,
                FCcutoff = 1,
                pointSize = 2.0,
                labSize = 5.0,
                colAlpha = 1,
                title = "MinION_Kit11",
                subtitle = NULL,
                legendPosition = 'bottom',
                legendLabSize = 12,
                legendIconSize = 4.0,
                drawConnectors = TRUE,
                widthConnectors = 0.2,
                col=colours)

Kit9_volcano <- EnhancedVolcano(genes_Kit9,
                lab = genes_Kit9$Symbol,
                x = 'log2foldchange.LLO.vs.Neg',
                y = 'BH.adjusted.p.values',
                xlab = bquote(~Log[2]~ 'fold change'),
                pCutoff = 0.05,
                FCcutoff = 1,
                pointSize = 2.0,
                labSize = 5.0,
                colAlpha = 1,
                title = "MinION_Kit9",
                subtitle = NULL,
                legendPosition = 'bottom',
                legendLabSize = 12,
                legendIconSize = 4.0,
                drawConnectors = TRUE,
                widthConnectors = 0.2,
                col=colours)
ggarrange(illumina_volcano, P2_volcano, Kit9_volcano, Kit11_volcano, ncol =2, nrow = 2, common.legend = TRUE)
```

**Rank Comparison for Illumina DEGs against Nanopore protocols**
```{r echo=TRUE}
genes_illumina_rank <- genes_illumina %>%
  filter(Id %in% illumina_genes_list)
genes_illumina_rank$rank <- seq.int(nrow(genes_illumina_rank))

genes_Kit9_rank <- genes_Kit9 %>%
  filter(Id %in% illumina_genes_list)
genes_Kit9_rank$rank <- seq.int(nrow(genes_Kit9_rank))

genes_Kit11_rank <- genes_Kit11 %>%
  filter(Id %in% illumina_genes_list)
genes_Kit11_rank$rank <- seq.int(nrow(genes_Kit11_rank))

genes_P2_rank <- genes_P2 %>%
  filter(Id %in% illumina_genes_list)
genes_P2_rank$rank <- seq.int(nrow(genes_P2_rank))

```

Ranking of Illumina DEGs Table
```{r message=FALSE, warning=FALSE}
rank_genes_illumina <- merge(genes_illumina_rank, genes_Kit9_rank, by = "Id",  all=T)
rank_genes_illumina <- rank_genes_illumina[,c(1,5,9,2,6,3,7)]
rank_genes_illumina <- merge(rank_genes_illumina, genes_Kit11_rank, by = "Id", all=T)
rank_genes_illumina <- rank_genes_illumina[,c(1,2,3,11,4,5,8 ,6,7,9)]
rank_genes_illumina <- merge(rank_genes_illumina, genes_P2_rank, by = "Id", all=T)
rank_genes_illumina <- rank_genes_illumina[,c(1,2,3,4,14,5,6,7,11,8,9,10,12)]
colnames(rank_genes_illumina) <- c("Id", "Rank_Illumina", "Rank_Kit9", "Rank_Kit11", "Rank_P2", 
                          "logFC_Illumina", "logFC_Kit9", "logFC_Kit11", "logFC_P2", 
                          "Adj.pval_Illumina", "Adj.pval_Kit9", "Adj.pval_Kit11", "Adj.pval_P2")
rank_genes_illumina <- rank_genes_illumina[order(rank_genes_illumina$Rank_Illumina),]

kable(rank_genes_illumina, "html") %>%
  kable_styling(full_width = F)
```

rank_genes_illumina <- rank_genes_illumina[,c(1,4,5,9)]
rank_genes_illumina <- merge(rank_genes_illumina, genes_Kit11_DE, by = "Id")
rank_genes_illumina <- rank_genes_illumina[,c(1:4,8)]
rank_genes_illumina <- merge(rank_genes_illumina, genes_P2_DE, by = "Id")
rank_genes_illumina <- rank_genes_illumina[,c(1:5,9)]
colnames(rank_genes_illumina) <- c("Id", "Symbol", "Rank_Illumina", "Rank_Kit9", "Rank_Kit11", "Rank_P2")
rank_genes_illumina <- rank_genes_illumina[order(rank_genes_illumina$Rank_Illumina),]

**Differential Genes Lists + Rank**

```{r echo=TRUE}
genes_illumina_DE <- genes_illumina[genes_illumina$log2foldchange.LLO.vs.Neg >=1 | genes_illumina$log2foldchange.LLO.vs.Neg <=(-1),]
genes_illumina_DE <- genes_illumina_DE[genes_illumina_DE$BH.adjusted.p.values < 0.05,]
genes_illumina_DE <- genes_illumina_DE[order(genes_illumina_DE$log2foldchange.LLO.vs.Neg,decreasing=TRUE),]
genes_illumina_DE$rank <- seq.int(nrow(genes_illumina_DE))

genes_Kit11 <- genes_Kit11[!is.na(genes_Kit11$log2foldchange.LLO.vs.Neg),]
genes_Kit11 <- genes_Kit11[!is.na(genes_Kit11$BH.adjusted.p.values),]
genes_Kit11_DE <- genes_Kit11[genes_Kit11$log2foldchange.LLO.vs.Neg >=1 | genes_Kit11$log2foldchange.LLO.vs.Neg <=(-1),]
genes_Kit11_DE <- genes_Kit11_DE[genes_Kit11_DE$BH.adjusted.p.values < 0.05,]
genes_Kit11_DE <- genes_Kit11_DE[order(genes_Kit11_DE$log2foldchange.LLO.vs.Neg,decreasing=TRUE),]
genes_Kit11_DE$rank <- seq.int(nrow(genes_Kit11_DE))

genes_Kit9 <- genes_Kit9[!is.na(genes_Kit9$log2foldchange.LLO.vs.Neg),]
genes_Kit9 <- genes_Kit9[!is.na(genes_Kit9$BH.adjusted.p.values),]
genes_Kit9_DE <- genes_Kit9[genes_Kit9$log2foldchange.LLO.vs.Neg >=1 | genes_Kit9$log2foldchange.LLO.vs.Neg <=(-1),]
genes_Kit9_DE <- genes_Kit9_DE[genes_Kit9_DE$BH.adjusted.p.values < 0.05,]
genes_Kit9_DE <- genes_Kit9_DE[order(genes_Kit9_DE$log2foldchange.LLO.vs.Neg,decreasing=TRUE),]
genes_Kit9_DE$rank <- seq.int(nrow(genes_Kit9_DE))

genes_P2 <- genes_P2[!is.na(genes_P2$log2foldchange.LLO.vs.Neg),]
genes_P2 <- genes_P2[!is.na(genes_P2$BH.adjusted.p.values),]
genes_P2_DE <- genes_P2[genes_P2$log2foldchange.LLO.vs.Neg >=1 | genes_P2$log2foldchange.LLO.vs.Neg <=(-1),]
genes_P2_DE <- genes_P2_DE[genes_P2_DE$BH.adjusted.p.values < 0.05,]
genes_P2_DE <- genes_P2_DE[order(genes_P2_DE$log2foldchange.LLO.vs.Neg,decreasing=TRUE),]
genes_P2_DE$rank <- seq.int(nrow(genes_P2_DE))
```


Table of DE genes found in all protocols

```{r}
rank_genes <- merge(genes_illumina_DE, genes_Kit9_DE, by = "Id")
rank_genes <- rank_genes[,c(1,4,5,9)]
rank_genes <- merge(rank_genes, genes_Kit11_DE, by = "Id")
rank_genes <- rank_genes[,c(1:4,8)]
rank_genes <- merge(rank_genes, genes_P2_DE, by = "Id")
rank_genes <- rank_genes[,c(1:5,9)]
colnames(rank_genes) <- c("Id", "Symbol", "Rank_Illumina", "Rank_Kit9", "Rank_Kit11", "Rank_P2")
rank_genes <- rank_genes[order(rank_genes$Rank_Illumina),]

kable(rank_genes, "html") %>%
  kable_styling(full_width = F)
```



**Venn Diagram Differentially Expressed Genes Shared Between Protocols**
```{r, echo=FALSE, fig.height=12, fig.width=15}
P2_Illumina <- venn.diagram(
  x = list(genes_illumina_DE$Id, genes_P2_DE$Id),
  category.names = c(paste0("Illumina (", nrow(genes_illumina_DE), ")"), 
                     paste0("P2 (", nrow(genes_P2_DE), ")")),
  filename = NULL,
  height = 400 , 
  width = 400 , 
  col=c("#440154ff", '#21908dff'),
  fill = c(alpha("#440154ff",0.3), alpha('#21908dff',0.3)),
  cex = 1,
  fontfamily = "sans",
  cat.cex = 1,
  cat.pos = c(-27, 27),
  cat.fontfamily = "sans",
  cat.col = c("#440154ff", '#21908dff'))

Kit9_Kit11_P2 <- venn.diagram(
  x = list(genes_Kit9_DE$Id, genes_Kit11_DE$Id, genes_P2_DE$Id),
  category.names = c(paste0("Kit9 (", nrow(genes_Kit9_DE), ")"), 
                     paste0("Kit11 (", nrow(genes_Kit11_DE), ")") , 
                     paste0("P2 (", nrow(genes_P2_DE), ")")),
  filename = NULL,
  height = 400 , 
  width = 400 , 
  col=c("#440154ff", '#21908dff',  "gold"),
  fill = c(alpha("#440154ff",0.3), alpha('#21908dff',0.3), alpha('gold',0.3)),
  cex = 1,
  fontfamily = "sans",
  cat.cex = 1,
  cat.pos = c(-10, 10, 180),
  cat.fontfamily = "sans",
  cat.col = c("#440154ff", '#21908dff', "darkorange"))

Kit9_Kit11_Illumina <- venn.diagram(
  x = list(genes_Kit9_DE$Id, genes_Kit11_DE$Id, genes_illumina_DE$Id),
  category.names = c(paste0("Kit9 (", nrow(genes_Kit9_DE), ")"), 
                     paste0("Kit11 (", nrow(genes_Kit11_DE), ")") , 
                     paste0("Illumina (", nrow(genes_illumina_DE), ")")),
  filename = NULL,
  height = 400 , 
  width = 400 , 
  col=c("#440154ff", '#21908dff',  "gold"),
  fill = c(alpha("#440154ff",0.3), alpha('#21908dff',0.3), alpha('gold',0.3)),
  cex = 1,
  fontfamily = "sans",
  cat.cex = 1,
  cat.pos = c(-10, 10, 180),
  cat.fontfamily = "sans",
  cat.col = c("#440154ff", '#21908dff', "darkorange"))

Kit9_Kit11_Illumina_P2 <- venn.diagram(
  x = list(genes_Kit9_DE$Id, genes_Kit11_DE$Id, genes_illumina_DE$Id, genes_P2_DE$Id ),
  category.names = c(paste0("Kit9 (", nrow(genes_Kit9_DE), ")"), 
                     paste0("Kit11 (", nrow(genes_Kit11_DE), ")") , 
                     paste0("Illumina (", nrow(genes_illumina_DE), ")"),
                     paste0("P2 (", nrow(genes_P2_DE), ")")),
  filename = NULL,
  height = 400 , 
  width = 400 , 
  col=c("#440154ff", '#21908dff',  "gold", "red"),
  fill = c(alpha("#440154ff",0.3), alpha('#21908dff',0.3), alpha('gold',0.3), alpha('red',0.3)),
  cex = 1,
  fontfamily = "sans",
  cat.cex = 1,
  cat.pos = c(-10, 10, 20, 30),
  cat.fontfamily = "sans",
  cat.col = c("#440154ff", '#21908dff', "darkorange", "red"))

ggarrange(Kit9_Kit11_P2, Kit9_Kit11_Illumina, P2_Illumina, Kit9_Kit11_Illumina_P2, ncol = 2, nrow=2)

```



